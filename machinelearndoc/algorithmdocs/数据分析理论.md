####数据分析理论


#####常用的数据分析方法论
######概述
   * 营销方面
    4P、用户使用行为、STP理论、SWOT等
   * 管理方面的理论模型
    PEST、5W2H、时间管理，生命周期、逻辑树、金字塔、SMART原则

#####一、 PEST 分析法
PEST分析法用于对宏观环境的分析。宏观环境又称为一般环境，是指影响一切行业和企业的各种宏观力量。一般会对应政治（Political）、经济(Economic)、技术(Technological)、社会（Social）这四大类影响企业的主要外部环境因素进行分析，

* 政治环境 
   政治体制，经济体制，财政体制，税收政策，产业政策，投资政策，专利数目，国防开支，政府补贴水平，民众对政治的参与度。

* 经济环境
  宏观： 国民收入 国名生产总值及其变化情况， 和通过这些指标反应的国民经济发展水平和发展速度。
  微观： 所在地区的消费者的收入水平、消费偏好、储蓄情况，就业程度等因素，这些因素决定着企业目前以及未来的市场大小。
  关键指标有： GDP以及增长律，利率。汇率，通货膨胀率，消费价格指数，居民可支配收入，失业率，劳动生产率等。
  
* 社会环境
  居民受教育程度和文化水平，宗教信仰，风俗习惯，观点，价值观念。
  指标： 人口规模， 性别比例，年龄结构，出生率，死亡率，种族结构，妇女生育率，生活方式，购买习惯，教育状况，城市特点，宗教信仰状况。
  
* 技术环境
  指标： 新技术的发明和进展， 折旧和报废的速度， 技术更新速度，计数传播速度，计数商品化速度，国家终点支持项目，国家投入的研发费用，专利个数，专利保护情况等因素，
  
#####二、5W2H
  5W2H分析法是以五个W开头的英文单词和两个H开头的英语单词进行提问， 从问答中发现解决问题的线索， 即何因(Why)、何事（what）、何人（Who）、何时（When）、何地（Where），如何做（How），何价（Hoe Much）
  以用户购买分析为例 ，使用5W2H建立用户购买行为分析框架。再根据分析框架中的这些问题形成可量化的指标进行衡量和评价； 如月购买次数，人均购买量，再次购买平均间隔时长。
  
  用户购买行为分析：
   1. why  用户购买的目的是什么 产品在哪方面吸引用户
   2、 what  公司提供什么产品服务  是否与用户需求一致
   3、 who   谁是我们的用户， 用户有哪些特点
   4、 when  何时购买  多久再次购买
   5、 where 用户在那里购买  用户在各个地区的构成怎样
   6、 how   用户的支付方式怎样
   7、 how much 购买花费的时间，交易等成本格式多少

#####三、 逻辑树分析法
它将问题的所有自问提分层罗列， 从最高层开始，并逐步向下扩展
将一个问题当作树干，然后开始考虑这个问题和那些相关问题有关。每想到一点就给这个问题所在的树干加一个 “树枝”，并标明这个树枝代表什么问题。大树枝上还可以有小树枝，
逻辑树的主要作用是帮你理清思路，避免进行重复和无关的思考。
逻辑树能保证解决问题的过程的完整性， 它可以将工作细分成便于操作的任务，确定各部分的优先顺序，明确的将责任落实到每个人。
逻辑树必须遵循的三个原则：
* 要素化： 将相同的问题总结归纳成要素。
* 框架化： 将各个要素组织成框架，遵循补充不漏原则。
* 关联化： 框架内的各要素保持必要的相互关系，简单而不孤立。

#####四、4P营销理论
营销组合实际上有几十个要素，这些要素可以概括为4类：产品(Product)、价格（Price）、渠道（place）、促销(Promotion)
 * 产品 ：  有形产品、服务、人员、组织、观念 或他们的组合。
 * 价格 ： 基本价格，折旧价格，支付期限。价格或价格决策关系到企业的利润、成本补偿、以及是否有利于产品销售、促销等问题。 影响定价的主要因素有三个： 需求、成本、与竞争。最高的价格取决与市场需求，最低价格取决于该产品的成本费用，在最高和最低价格的幅度内，企业可以将这种该产品的价格定多高，取决于竞争者的同种产品的价格。
 * 渠道（）： 产品从企业到用户手上的全过程中所经历的各个环节。
 * 促销  指企业通过销售行为来改变刺激用户消费，以短期的行为导致提前消费来促进销售的增长。广告、宣传推广、人员推销、销售促进是一个机构促销组合的四大要素。

#####五、用户行为理论
  网站分析的发展已经较为成熟，有一套成熟的分析指标 。 如 IP，PV，页面停留时间，跳出率，回访者，新访问者，回访次数，回访间隔天数，流失率，关键字搜索，转化率，登录率，
  用户使用行为是指用户为获取，使用物品或服务所采取的各种行动，用户对产品首先需要有一个认知，熟悉的过程，然后试用，再决定是否继续消费使用，最后称为忠实用户
  可以利用用户使用行为理论，梳理网站分析的各个关键指标之间的逻辑关系，构建符合公司实际业务的网站分析指标体系：
  用户行为轨迹         用户的网站行为         网站分析指标
  认知             网站访问         IP PV 人均页面访问量 访问来源
  
  熟悉             网站测数          平均访问时长， 跳出律页面偏好
  --              站内搜索          搜索访问次数占比
  
  试用             用户注册          用户数，注册转化率
  
  使用             用户登录          登录用户数，人均登录， 访问登录比
  --              用户订购          订购量，订购频次，内容，转化率
  
  忠诚             用户粘性          回访者比率 ， 访问深度
  --              用户流失          用户流失数，流失率
  
 
 
#####数据分析步骤
第一步 数据清洗   ：
  将多余重复的数据筛选清除，将缺失的数据补充完整，将错误的数据纠正或删除。
第二步  数据加工
  对数据字段进行信息提取，计算，分组，转换等加工
  
###### 1、 数据清洗
   1. 重复数据
     * 函数法  COUNTIF  :
      COUNTIF(range,criteria) : 对区域中满足条件的单元格计数
     * 筛选法
     *  条件格式法
     开始->条件格式->突出显示单元格规则->重复值    重复标记不同颜色
     * 数据透视法
     *删除重复数据
   2.  缺失数据
      * 定位输入
      * 用一个样本统计量的值代替样本的缺失值 如样本均值
      * 用统计模型计算出来的值代替缺失值， 常用的有回归模型，判别模型
      * 将有缺失域的记录删除
      * 尽在相应的分析中作必要的排除  
   3. 检查数据逻辑错误 
   	  * 利用IF函数检查错误
   	  * 利用条件格式标记错误
###### 2. 数据加工
   1. 数据抽取
       保留数据表中某些字段的部分信息，组合成一个新的字段 可以是 字段分列 字段合并 字段匹配
     * 字段分裂
        菜单法
        函数法 LEFT（text,[num_chars]）  RIGHT(text,[num_chars])
        
     * 字段合并
       CONCATENATE函数 =CONCATENATE（A7，”迟到“,B2,"次"）
       & 运算符  =A2&"迟到"&B2&"次"      =A3&"迟到比例为"&TEXT(B3,"0%")
       
     * 字段匹配 从其他数据表中获取字段
        VLOOKUP函数
   2. 数据计算
     * 简单计算  =B2 * C3    sum(D2,D6)
     * 函数求和 ： 
          AVERAGE（B2:E2）
          SUM（B5:E5）
     * 日期的加减
        NOW / TODAY
        A1 + 5   A1： 2011-1-1 -》 2011-1-6
        =DATE(YEAR(A2)+3,MONTH(A2) + 1,DAY(A2) + 5)
        DATADIF(start_date,end_date, unit)  Y MD YM YD
    3. 数据分组
       VLOOKUP
    4. 数据转换
       * 行列转换
     HLOOKUP ：安行查找 VLOOKUP 按列查找
    5. 数据抽样
     RAND
     =RAND（） * 10 + 60
     =INT（RAND() * 10 + 60）
     =RAND()*(b-a)+ a

#####数据分析方法
 
 数据分析六步曲  : 1.明确分析目的和分析思路 2. 数据收集 3 数据处理 4数据分析 5 数据展现 6 报告撰写
 
 数据分析方法有以下几种 ：
   1. 对比分析法  2分组分析法 3结构分析法 4平均分析法 5交叉分析法 6综合评价分析法
   7 杜邦分析法 8漏斗图分析法 9 矩阵关联分析法 10高级数据分析法
  
  数据分析作用         基本方法       数据分析方法
  
  现状分析            对比           对比分析 
   --                             平均分析
   --                             综合评分分析 
   --                              ...
  原因分析            细分           分组分析
  --                              结构分析
  --                              交叉分析分析
  --                              杜邦分析
  --                              漏斗图分析
  --                              矩阵相关分析
  --                              聚类分析
  --                              ...
  预测分析            预测           回归分析
  --                              时间序列
  --                              决策树
  --                              神经网络
  
  
  
######1。 对比分析法
定义： 将两个或者两个以上的数据进行比较，分析他们之间的差异，来揭示数据代表的事物发展变化情况和规律性。 
特点：可以直观的看出事物方面的变化或差距，可以准确，量化的表示出这种变化和差距是多少
分类： 静态比较和动态比较
   * 静态比较： 在同一时间条件下对不同指标的比较，如不同部门，地区，国家 也叫横向比较（横比）
   * 动态比较 在同一总体条件下对不同时期指标数值的比较，也叫做纵向比较（纵比）

  这种方法可以单独使用，也可以结合使用，进行对比分析时，可以单独使用总量指标，相对指标或平均指标，也可以将他们结合起来进行对比，比较的结果可以使用相对数表示，如百分数，等指标。
  常用的有以下几个纬度：
  1. 与目标对比
  2. 不同时期对比
  3. 同部门，单位，地区进行对比
  4. 行业内对比       （横比）
  5. 活动效果对比 （活动前后 比较，分析营销效果）（纵比）ABtest（纵比）
  注意： 
  * 指标口径范围，计算方法，计量单位必须一致
  * 对比对象要有可比性
  * 对比的指标类型必须一致
  
######2. 分组分析法
  不仅要分析总体的数量特征和数量关系，还要深入总体的内部进行分组分析。 分组分析根据数据分析对象的特征，按照一定的标志（指标），将数据分析对象划分为不同的部分和类型来进行研究， 以揭示其内在的联系和规律性。
  分组的目的是为了便于对比，将总体中具有不同性质的对象区分开来，将性质相同的对象合并到一起，保持各组内对象属性的一致性，组与组之间属性的差异性，以便于进一步用各种数据分析方法，来解构内在的数量关系，所以分组法必须与对比法结合运用。
  分组分析的关键在于确定组数与组距。 组上限 组下限 组距 组中值
  分好组后，我们可以进行相应信息的分组汇总分析，从而对比各组之间的差异，以及与总体间的差异情况。

###### 3. 结构分析法
被分析总体内部的各部分与总体之间进行对比的分析方法，即总体内各部分占总体的比例，属于相对指标，一般某部分的比例越大，说明其重要程度越高，对总体的影响越大。
   结构相对指标（比例） = (总体某部分的数值/ 总体总量) * 100%
   如 市场占有率：
   市场占有率 = （某种商品销售量 / 该种商品市场销售总量） * 100 %
   
######4. 平均分析法
 反应总体在一定时间、地点、条件下的某一数量的一般平均水平。
 * 利用平均指标对比同类现象在不同地区、不同行业、不同单位之间的差异成都，比用总量指标对比更具有说服力。
 * 利用平均指标对比某些现象在不同历史时期的变化， 更能说明其发展趋势和规律
 平均指标有算数平均数，调和平均数，几何平均数，众数和中位数。

######5. 交叉分析法
交叉分析法通常用于分析两个变量（字段）之间的关系， 即同时将两个有一定联系的变量及其值交叉排列在一张表格中，使各变量值成为不同变量的交叉节点，形成交叉表，从而分析交叉表中变量之间的关系，所以也叫做交叉表分析法。交叉表当然也有二维以上的，纬度越多，交叉表就越复杂，所以在选择几个纬度的时候需要根据分析的目的决定。

######6. 综合评价分析法
运用多个指标对多个参评单位进行评价的方法。（多变量综合评价分析方法）
基本思想：
 将多个指标转化为一个能够反映综合情况的指标来进行分析评价，如不同国家的经济实力，不同地区的社会发展水平，小康生活水平达标进程，企业经济效益评价等，都可用这种方式：
 主要有五个步骤：
 1.  确定综合评价体系，即包含哪些指标，是综合评价的基础和依据。
 2. 收集数据，并对不同统计量单位的指标数据进行标准化处理。
 3. 确定指标体系中各个指标的权重，以保证评价的科学性。
 4. 对经处理后的指标再进行汇总，计算出综合评价指数，或综合评价分值。
 5. 根据评价指数或分值对参评单位进行排序，并由此得出结论。
 
 * 0-1标准化 （离差标准化）
     w = (v - vmin) / (vmax - vmin)
    
 * 权重确定方法
   专家访谈法， 德尔菲法，层次分析法，主成份分析法，因子分析法，回归分析法
   简单的方法 ： 目标优化矩阵表
   专家评分 
   某指标权重 = （某指标新的重要性合计得分 / 所有指标新的重要性合计得分） * 100 %

###### 7. 杜邦分析法
   是一种综合分析方法，又称为杜邦财务体系，它利用各主要财务指标间的内在联系，对企业财务状况以及经济效益进行综合分析评价的方法。
   
   
###### 8 . 漏斗图分析法
以漏斗的形式展现分析过程以及结果的。
漏斗图是一个适合业务流程较规范，周期较长，各流程环节设计复杂业务的过程比较多的管理分析工具。它是对业务流程最直观的一种表现形式， 最能说明问题所在，通过漏斗图可以很快法相业务流程中存在问题的环节
  如漏斗图用于网站中某些关键路径的转化率的分析，不仅可以显示用户从进入该网站到实现购物的最终转化率，同时还可以展示整个关键路径中每一步的转化律
   
   浏览商品       100%
   放入购物车       40%
   生成订单         30%
   支付订单         20%
   完成交易         17%

单一的漏斗图无法评价网站，某个关键流程中各步转化律的好坏。可以利用之前介绍的对比分析方法，对同一环节优化前后的效果进行对比分析，或对同一环节不同细分用户群的转化率作比较，或对同行业类似产品的转化律进行对比，etc
漏斗图不仅可以告诉我们用户在业务中的转化率和流失率，还可以告诉我们各种业务在网站中的受欢迎成度。对不同业务的漏斗图进行对比，可以找出何种业务在网站中更受用户的欢迎或更吸引用户。只要掌握了前面介绍的对比分析法， 就可以从不同的业务角度发现隐藏在其中的业务问题。


######矩阵关联分析法
关联分析法根据事物（如产品，服务等）的两个重要属性（指标）作为分析的依据，进行分类相关的分析，找出解决问题的一种分析方法。
*  优先改进矩阵（资源配置矩阵）  （逆时针排列）
   第一象限  （高度关注区）   重要性高， 满意度高
   第二象限  （优先改进区）   重要性高， 满意度低
   第三象限  （无关紧要区）   重要性低， 满意度低
   第四象限   (优势维持区)   重要性低， 满意度高
   
* 发展矩阵
  将三年的数据都绘制在一张矩阵图中，并用箭头将每个服务项目在三年内的变化标注出来。
 
* 改进难易矩阵
  使用综合方法中的  目标优化矩阵来 确定最终指标的改进难易程度， 在图像上以气泡的大小体现。
   
   
######高级数据分析方法

研究方向        数据分析方法

产品研究       相关分析， 对应分析， 判别分析， 综合分析， 多维尺度分析
品牌研究       相关分析   聚类分析  判别分析  因子分析   对应分析 ， 多维尺度分析
价格研究       相关分析  PSM价格分析
市场细分       聚类分析  判别分析  因子分析 对应分析  多维尺度分析 ， logistic回归，              决策树
满意度研究     相关分析， 回归分析， 主成份分析，因子分析， 结构分析
用户研究       相关分析 聚类分析  判别分析 因子分析 对应分析 logistic回归 ，决策树，              关联规则

预测决策       回归分析 决策树 神经网络 ， 时间序列 logistic回归


#####透视表
它是对Excel数据表中的各个字段进行快速分类汇总的一种分析工具。是一种交互式报表。
轴  数据表中的一个纬度，如行 列或页
数据源 
字段   相当于数据表中的列
字段标题 可以通过拖动字段标题对数据透视表进行透视分析
透视   通过改变一个或多个字段的位置来重新安排数据透视表
汇总函数 
刷新

   
   
######数据展现

图标 主要分六类：
表格、饼图、条形图、柱形图、折线图、散点图

数据关系可以分为六类 :
 成分、排序、时间序列、频率分布、相关性、多重数据比较。
 
 * 成分 
 也叫构成，表示整体的一部分， 一般用饼图表示， 还可以用 柱形图，条形图，瀑布图

* 排序
 柱形图 条形图 气泡图，帕累托图
 
* 时间序列
 表示某事按一定的时间顺序发展的走势、趋势。
 柱状图 ， 折线图，面积图。
 
* 频率分布
 与排序一样都用与各个项目，类别间的比较。柱状图， 条形图 ，折线图
 
* 相关性
 柱状图，对称条形图（旋风图） ，散点图 ，气泡图
 
* 多重数据比较
 用雷达图
   

图标制作五步：
 
1. 确定要表达的主题、目的
2. 确定那种图标更适合你的目的
3. 选择数据制作图标
4. 检查是否真实有效的表示数据
5. 检查是否表达了你的观点
   
表格展示数据
当需要呈现的数据在3个系列及以上，尤其是数据间的量刚不同的时候，用表格展示效果更好。

1. 突出显示单元格
  根据指定的规则，将表格中符合条件的单元个用不同的颜色背景，字体颜色将数据突出显示出来。

2. 项目选取
3. 数据条
4. 数据条可以帮你查看某个单元格相对于其他单元格的值， 数据条的长度代表单元格中的值。数据条越长，表示值越大；数据条越短，表示值越小。
5. 图标集
   使用图标集可以对数据进行注释，可以按照阈值（就是临界值），将数据分成3～5个类别，每个图标代表一个范围的值。
6.迷你图
可以放在一个单元格中。


图表组合
1. 平均线图 ： 在原来的柱形图或者折线图上添加一条平行线
2. 双坐标图
3. 竖折线图 ： 带平滑线和数据标记的散点图。通过两个辅助数据来增加对应的标签。
4. 瀑布图： 
5. 怕累托图： 二八法则 （排列图，主次图） 按照发生频率的高低顺序绘制的直方图（无间距的柱形图）
6. 旋风图 ： 
7.人口金字塔